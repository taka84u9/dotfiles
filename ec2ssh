profiles 'default'
regions 'ap-northeast-1'

# Ignore unnamed instances
reject {|instance| !instance.tags['Name'] }

# You can use methods of AWS::EC2::Instance.
# See http://docs.aws.amazon.com/AWSRubySDK/latest/AWS/EC2/Instance.html
host_line <<EOS
<% if tags['Name'] == 'bastion-qiita' %>
Host <%= tags['Name'] %>
  HostName <%= dns_name || private_ip_address %>
  Port <%= ENV['INCREMENTS_HOST_PORT'] %>
  User ec2-user
  IdentityFile ~/.ssh/<%= ENV['INCREMENTS_SSH_KEY_NAME'] %>
<% else %>
Host <%= tags['Name'] %>
  User ec2-user
  ProxyCommand ssh -W <%= private_ip_address %>:<%= ENV['INCREMENTS_HOST_PORT'] %> bastion-qiita
<% end %>
EOS
# vim: set filetype=ruby :
